<div class="all-title-box">
    <div class="container text-center">
        <h1>
            <%= user.name %><span class="m_1">Lorem Ipsum dolroin gravida nibh vel velit.</span>
        </h1>
    </div>
</div>

<div class="offset-1 col-xl-10 col-md-10 col-sm-10">
    <% if(flashMessages){ %>
        <% if(flashMessages.success){ %>
            <div class="alert alert-success">
                <%= flashMessages.success %>
            </div>

            <% }else if(flashMessages.error){ %>
                <div class="alert alert-danger">
                    <%= flashMessages.error %>
                </div>
                <% } %>
                    <% } %>
</div>

<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Delete Course</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete <mark name="deleteCourseName" id="deleteCourseName"></mark>course?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                <a id="deleteLink" name="deleteLink" href="" type="button" class="btn btn-primary">Delete Course</a>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="UpdateModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <form id="UpdateLink" action="/courses" method="POST">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Update Course</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-horizontal">

                        <div class="form-group">
                            <label for="description">Course Name</label>
                            <input type="text" id="UpName" name="name" class="form-control" id="description"
                                placeholder="Course Name" value="valueBurda" required>
                        </div>

                        <div class="form-group">
                            <label for="description">Category Name</label>

                            <select class="form-control" id="UpCategory" name="category">
                                <% for(i=0; categories.length> i ; i++ ){ %> 
                                    <option value="<%= categories[i]._id %>"><%= categories[i].name %></option>
                                <% } %>
                            </select>

                        </div>


                        <div class="form-group">
                            <label for="description">Course Description</label>
                            <textarea id="UpDescription" name="description" class="form-control" id="description"
                                rows="3" required> f </textarea>
                        </div>


                        <div class="form-group">
                            <input type="hidden" name="role" class="form-control" value="<%= user.role %>" required>
                        </div>


                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-lg btn-danger rounded-0 text-white"
                        data-dismiss="modal">Close</button>
                    <button  value="LOGIN" id="submit"
                        class="btn btn-lg btn-warning rounded-0 text-white">Update</button>
                </div>
            </form>
        </div>
    </div>
</div>


<!-- Modal -->
<div class="modal fade" id="addCourse" tabindex="-1" role="dialog" aria-labelledby="addCourse" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <form action="/courses" method="POST">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Add Course</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-horizontal">

                        <div class="form-group">
                            <label for="description">Course Name</label>
                            <input type="text" name="name" class="form-control" id="description"
                                placeholder="Course Name" required>
                        </div>

                        <div class="form-group">
                            <label for="description">Category Name</label>

                            <select class="form-control" name="category">
                                <% for(i=0; categories.length> i ; i++ ){ %> <option value="<%= categories[i]._id %>">
                                        <%= categories[i].name %>
                                    </option>
                                    <% } %>
                            </select>

                        </div>


                        <div class="form-group">
                            <label for="description">Course Description</label>
                            <textarea name="description" class="form-control" id="description" rows="3"
                                required></textarea>
                        </div>


                        <div class="form-group">
                            <input type="hidden" name="role" class="form-control" value="<%= user.role %>" required>
                        </div>


                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-lg btn-danger rounded-0 text-white"
                        data-dismiss="modal">Close</button>
                    <button type="submit" value="LOGIN" id="submit"
                        class="btn btn-lg btn-warning rounded-0 text-white">Save changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="overviews" class="section wb">
    <div class="container">
        <div class="row">



            <div class="col-lg-12 text-center">
                <button type="button" class="btn btn-lg btn-warning rounded-0 text-white" data-toggle="modal"
                    data-target="#addCourse">
                    Launch demo modal
                </button>

            </div>



            <div class="col-lg-12 blog-post-single">
                <div class="blog-author">
                    <div class="author-bio">
                        <h3 class="author_name"><a href="#"></a></h3>
                        <h5>Student at <a href="#">SmartEDU</a></h5>
                        <p class="author_det">
                            Cousers
                        </p>
                    </div>
                </div>

            </div><!-- end col -->



        </div><!-- end row -->
        <div class="row mt-5">
            <% for(i=0 ; courses.length> i ; i++){ %>
                <div class="col-lg-6 col-md-6 col-12">
                    <div class="course-item mb-5">
                        <div class="image-blog">
                            <img src="/images/blog_2.jpg" alt="" class="img-fluid">
                        </div>
                        <div class="course-br">
                            <div class="course-title">
                                <h2><a id="na-<%= courses[i].slug %>" href="/courses/<%= courses[i].slug %>" title="">
                                        <%= courses[i].name %>
                                    </a></h2>
                                <a id="cId-<%= courses[i].slug %>" hidden>
                                    <%= courses[i].category._id %>
                                </a>

                            </div>
                            <div class="blog-desc">
                                <p id="des-<%= courses[i].slug %>" hidden>
                                    <%= courses[i].description %>
                                </p>
                                <p>
                                    <%= courses[i].description.substring(0,100) + "..." %>
                                </p>
                            </div>
                            <div class="clearfix">
                                <ul class="list-unstyled">
                                    <li style="float: left;"><button class="btn btn-primary rounded-0 text-white"
                                            onclick="clickUpdateButton('<%= courses[i].slug %>')" data-toggle="modal"
                                            data-target="#UpdateModal"><span>Update</span></button>
                                    </li>
                                    <li style="float: right;"><button id="deleteB"
                                            onclick="clickDeleteButton('<%= courses[i].slug %>')"
                                            class="btn btn-danger rounded-0 text-white" data-toggle="modal"
                                            data-target="#deleteModal"><span>Delete</span></button>
                                    </li>

                                </ul>
                            </div>
                        </div>
                    </div>
                </div><!-- end col -->

                <% } %>
        </div><!-- end row -->
    </div><!-- end container -->
</div><!-- end section -->
<script>
    function clickDeleteButton(s) {
        $("#deleteLink").attr("href", `/courses/${s}?_method=DELETE`);
        $("#deleteCourseName").html($(`#na-${s}`)[0]);

    }
    function clickUpdateButton(s) {
        let id =$(`#cId-${s}`)[0].innerText.trim()
        $(`#UpCategory  option[value="${id}"]`).prop("selected", true);
        $("#UpdateLink").attr("action", `/courses/${s}?_method=PUT`);
        $("#UpDescription").html($(`#des-${s}`)[0].innerText.trim());
        $("#UpName").val($(`#na-${s}`)[0].innerText.trim())
        $("#UpName").html($(`#na-${s}`)[0].innerText.trim());
    }
</script>